{% extends 'base.html' %}
{% block title %}Edit Attendance{% endblock %}

{% block content %}
<div class="container mt-4">
  <h2>Edit Attendance</h2>
  <p class="text-muted">{{ student.fullname }} - {{ subject.name }}</p>
  <a href="{% url 'score' %}" class="btn btn-secondary mb-3">Go Back</a>

  <form method="post">
    {% csrf_token %}
    <div class="table-responsive">
      <table class="table table-striped table-bordered">
        <thead class="table-dark">
          <tr>
            <th>Week</th>
            <th>Session 1</th>
            <th>Session 2</th>
            <th>Session 3</th>
            <th>Session 4</th>
          </tr>
        </thead>
        <tbody>
          {% for item in attendance_records %}
          <tr>
            <td>Week {{ item.session.week_number }}</td>
            <td>
              <select name="attendance_{{ item.session.id }}_session_1" class="form-select form-select-sm">
                <option value="P" {% if item.record.session_1 == 'P' %}selected{% endif %}>Present</option>
                <option value="A" {% if item.record.session_1 == 'A' %}selected{% endif %}>Absent</option>
                <option value="L" {% if item.record.session_1 == 'L' %}selected{% endif %}>Late</option>
                <option value="E" {% if item.record.session_1 == 'E' %}selected{% endif %}>Excused</option>
              </select>
            </td>
            <td>
              <select name="attendance_{{ item.session.id }}_session_2" class="form-select form-select-sm">
                <option value="P" {% if item.record.session_2 == 'P' %}selected{% endif %}>Present</option>
                <option value="A" {% if item.record.session_2 == 'A' %}selected{% endif %}>Absent</option>
                <option value="L" {% if item.record.session_2 == 'L' %}selected{% endif %}>Late</option>
                <option value="E" {% if item.record.session_2 == 'E' %}selected{% endif %}>Excused</option>
              </select>
            </td>
            <td>
              <select name="attendance_{{ item.session.id }}_session_3" class="form-select form-select-sm">
                <option value="P" {% if item.record.session_3 == 'P' %}selected{% endif %}>Present</option>
                <option value="A" {% if item.record.session_3 == 'A' %}selected{% endif %}>Absent</option>
                <option value="L" {% if item.record.session_3 == 'L' %}selected{% endif %}>Late</option>
                <option value="E" {% if item.record.session_3 == 'E' %}selected{% endif %}>Excused</option>
              </select>
            </td>
            <td>
              <select name="attendance_{{ item.session.id }}_session_4" class="form-select form-select-sm">
                <option value="P" {% if item.record.session_4 == 'P' %}selected{% endif %}>Present</option>
                <option value="A" {% if item.record.session_4 == 'A' %}selected{% endif %}>Absent</option>
                <option value="L" {% if item.record.session_4 == 'L' %}selected{% endif %}>Late</option>
                <option value="E" {% if item.record.session_4 == 'E' %}selected{% endif %}>Excused</option>
              </select>
            </td>
          </tr>
          {% empty %}
          <tr>
            <td colspan="5" class="text-center">No attendance records found.</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <div class="mt-3">
      <button type="submit" class="btn btn-success">Save</button>
      <a href="{% url 'score' %}" class="btn btn-secondary">Cancel</a>
    </div>
  </form>
</div>
{% endblock %}

