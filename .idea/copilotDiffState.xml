<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/edutrack/templates/student_record.html">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/edutrack/templates/student_record.html" />
              <option name="originalContent" value="{% extends 'base.html' %}&#10;{% load static %}&#10;{% block title %}Student Record{% endblock %}&#10;&#10;{% block content %}&#10;    &lt;h2&gt;Student Record&lt;/h2&gt;&#10;&lt;button type=&quot;button&quot; class=&quot;btn btn-primary&quot; data-bs-toggle=&quot;modal&quot; data-bs-target=&quot;#addStudentRecordModal&quot;&gt;Add Student&lt;/button&gt;&#10;&#10;&lt;div class = &quot;table-responsive&quot;&gt;&#10;&lt;table class=&quot;table table-hover&quot;&gt;&#10;  &lt;tbody&gt;&#10;    &lt;tr&gt;&#10;      &lt;th scope=&quot;col&quot;&gt;Student ID&lt;/th&gt;&#10;      &lt;th scope=&quot;col&quot;&gt;Fullname&lt;/th&gt;&#10;      &lt;th scope=&quot;col&quot;&gt;Grade &amp; Section&lt;/th&gt;&#10;      &lt;th scope=&quot;col&quot;&gt;Gender&lt;/th&gt;&#10;       &lt;th scope=&quot;col&quot;&gt;Age&lt;/th&gt;&#10;      &lt;th scope=&quot;col&quot;&gt;Address&lt;/th&gt;&#10;      &lt;th scope=&quot;col&quot;&gt;Parent/Guardian&lt;/th&gt;&#10;      &lt;th scope=&quot;col&quot;&gt;Parent/Guardian Contact&lt;/th&gt;&#10;       &lt;th scope=&quot;col&quot;&gt;Status&lt;/th&gt;&#10;      &lt;th scope=&quot;col&quot;&gt;Actions&lt;/th&gt;&#10;    &lt;/tr&gt;&#10;  &lt;/tbody&gt;&#10;  {% for student in page_obj %}&#10;  &lt;tr&gt;&#10;    &lt;td&gt;{{ student.student_id}}&lt;/td&gt;&#10;    &lt;td&gt;{{ student.fullname}}&lt;/td&gt;&#10;    &lt;td&gt;{{ student.grade_and_section}}&lt;/td&gt;&#10;    &lt;td&gt;{{ student.gender}}&lt;/td&gt;&#10;    &lt;td&gt;{{ student.age}}&lt;/td&gt;&#10;    &lt;td&gt;{{ student.address}}&lt;/td&gt;&#10;    &lt;td&gt;{{ student.parent}}&lt;/td&gt;&#10;    &lt;td&gt;{{ student.parent_contact}}&lt;/td&gt;&#10;    &lt;td&gt;{{ student.status}}&lt;/td&gt;&#10;    &lt;td&gt;&#10;&lt;button type=&quot;button&quot;&#10;        class=&quot;btn btn-success me-1&quot;&#10;        data-bs-toggle=&quot;modal&quot;&#10;        data-bs-target=&quot;#mymodal{{student.id}}&quot;&gt;&#10;  &lt;i class=&quot;fa-solid fa-circle-info&quot;&gt;&lt;/i&gt;&#10;&lt;/button&gt;&#10;&#10;&lt;!--      modal view student--&gt;&#10;  &lt;div class=&quot;modal&quot; id =&quot;mymodal{{student.id}}&quot; tabindex=&quot;-1&quot; aria-labelledby=&quot;mymodalLabel{{student.id}}&quot; aria-hidden=&quot;true&quot;&gt;&#10;  &lt;div class=&quot;modal-dialog&quot; role=&quot;document&quot;&gt;&#10;    &lt;div class=&quot;modal-content&quot;&gt;&#10;      &lt;div class=&quot;modal-header&quot;&gt;&#10;        &lt;h5 class=&quot;modal-title&quot;&gt;&#10;          Student: {{ student.fullname}}&#10;        &lt;/h5&gt;&#10;        &lt;button type=&quot;button&quot; class=&quot;btn-close&quot; data-bs-dismiss=&quot;modal&quot; aria-label=&quot;Close&quot;&gt;&#10;          &lt;span aria-hidden=&quot;true&quot;&gt;&lt;/span&gt;&#10;        &lt;/button&gt;&#10;      &lt;/div&gt;&#10;      &lt;div class=&quot;modal-body&quot;&gt;&#10;        &lt;ul class=&quot;list-unstyled&quot;&gt;&#10;          &lt;li&gt;Student ID: &lt;strong&gt; {{ student.student_id}} &lt;/strong&gt;&lt;/li&gt;&#10;          &lt;li&gt;Fullname: &lt;strong&gt; {{ student.fullname}}&lt;/strong&gt;&lt;/li&gt;&#10;          &lt;li&gt;Grade &amp; Section: &lt;strong&gt; {{ student.grade_and_section}}&lt;/strong&gt;&lt;/li&gt;&#10;          &lt;li&gt;Gender: &lt;strong&gt; {{ student.gender}}&lt;/strong&gt;&lt;/li&gt;&#10;          &lt;li&gt;Age: &lt;strong&gt; {{ student.age}}&lt;/strong&gt;&lt;/li&gt;&#10;          &lt;li&gt;Address: &lt;strong&gt; {{ student.address}}&lt;/strong&gt;&lt;/li&gt;&#10;          &lt;li&gt;Parent/Guardian: &lt;strong&gt; {{ student.parent}}&lt;/strong&gt;&lt;/li&gt;&#10;          &lt;li&gt;Parent/Guardian Contact: &lt;strong&gt; {{ student.parent_contact}}&lt;/strong&gt;&lt;/li&gt;&#10;          &lt;li&gt;Status: &lt;strong&gt; {{ student.status}}&lt;/strong&gt;&lt;/li&gt;&#10;        &lt;/ul&gt;&#10;      &lt;/div&gt;&#10;      &lt;div class=&quot;modal-footer&quot;&gt;&#10;        &lt;button type=&quot;button&quot; class=&quot;btn btn-primary&quot; data-bs-dismiss=&quot;modal&quot;&gt;Close&lt;/button&gt;&#10;      &lt;/div&gt;&#10;    &lt;/div&gt;&#10;  &lt;/div&gt;&#10;&lt;/div&gt;&#10;&lt;!--      modal delete student--&gt;&#10;      &lt;button type=&quot;button&quot; class=&quot;btn btn-warning me-1 edit-student-btn&quot; data-student-id=&quot;{{ student.id }}&quot;&gt;&#10;        &lt;i class=&quot;fa-solid fa-pen-to-square&quot;&gt;&lt;/i&gt;&#10;      &lt;/button&gt;&#10;      &lt;button type=&quot;button&quot; class=&quot;btn btn-danger&quot; data-bs-toggle = &quot;modal&quot; data-bs-target=&quot;#delete{{student.id}}&quot;&gt;&#10;        &lt;i class=&quot;fa-solid fa-trash-can&quot;&gt;&lt;/i&gt;&#10;      &lt;/button&gt;&#10;      &lt;div class=&quot;modal&quot; id =&quot;delete{{student.id}}&quot; tabindex=&quot;-1&quot; aria-labelledby=&quot;mymodalLabel{{student.id}}&quot; aria-hidden=&quot;true&quot;&gt;&#10;  &lt;div class=&quot;modal-dialog&quot; role=&quot;document&quot;&gt;&#10;    &lt;div class=&quot;modal-content&quot;&gt;&#10;      &lt;div class=&quot;modal-header&quot;&gt;&#10;        &lt;h5 class=&quot;modal-title&quot;&gt;&#10;          Student: {{ student.fullname}}&#10;        &lt;/h5&gt;&#10;        &lt;button type=&quot;button&quot; class=&quot;btn-close&quot; data-bs-dismiss=&quot;modal&quot; aria-label=&quot;Close&quot;&gt;&#10;          &lt;span aria-hidden=&quot;true&quot;&gt;&lt;/span&gt;&#10;        &lt;/button&gt;&#10;      &lt;/div&gt;&#10;      &lt;div class=&quot;modal-body&quot;&gt;&#10;        &lt;p&gt;Are you sure you want to delete this student?&lt;/p&gt;&#10;      &lt;/div&gt;&#10;     &lt;div class=&quot;modal-footer&quot;&gt;&#10;  &lt;form action=&quot;{% url 'delete' student.id %}&quot; method=&quot;POST&quot;&gt;&#10;    {% csrf_token %}&#10;    &lt;input type=&quot;submit&quot; class=&quot;btn btn-danger&quot; value=&quot;Delete&quot;&gt;&#10;    &lt;button type=&quot;button&quot; class=&quot;btn btn-secondary&quot; data-bs-dismiss=&quot;modal&quot;&gt;Cancel&lt;/button&gt;&#10;  &lt;/form&gt;&#10;&lt;/div&gt;&#10;&#10;      &lt;/div&gt;&#10;    &lt;/div&gt;&#10;  &lt;/div&gt;&#10;&lt;/div&gt;&#10;&#10;    &lt;/td&gt;&#10;  &lt;/tr&gt;&#10;  {%endfor%}&#10;&lt;/table&gt;&#10;&#10;&lt;!-- Pagination --&gt;&#10;{% if page_obj %}&#10;&lt;nav aria-label=&quot;Page navigation&quot; class=&quot;mt-3&quot;&gt;&#10;    &lt;ul class=&quot;pagination justify-content-center&quot;&gt;&#10;        {% if page_obj.has_previous %}&#10;            &lt;li class=&quot;page-item&quot;&gt;&#10;                &lt;a class=&quot;page-link&quot; href=&quot;?page={{ page_obj.previous_page_number }}&quot;&gt;Previous&lt;/a&gt;&#10;            &lt;/li&gt;&#10;        {% endif %}&#10;        &#10;        {% for num in page_obj.paginator.page_range %}&#10;            {% if page_obj.number == num %}&#10;                &lt;li class=&quot;page-item active&quot;&gt;&lt;span class=&quot;page-link&quot;&gt;{{ num }}&lt;/span&gt;&lt;/li&gt;&#10;            {% elif num &gt; page_obj.number|add:'-3' and num &lt; page_obj.number|add:'3' %}&#10;                &lt;li class=&quot;page-item&quot;&gt;&#10;                    &lt;a class=&quot;page-link&quot; href=&quot;?page={{ num }}&quot;&gt;{{ num }}&lt;/a&gt;&#10;                &lt;/li&gt;&#10;            {% endif %}&#10;        {% endfor %}&#10;        &#10;        {% if page_obj.has_next %}&#10;            &lt;li class=&quot;page-item&quot;&gt;&#10;                &lt;a class=&quot;page-link&quot; href=&quot;?page={{ page_obj.next_page_number }}&quot;&gt;Next&lt;/a&gt;&#10;            &lt;/li&gt;&#10;        {% endif %}&#10;    &lt;/ul&gt;&#10;&lt;/nav&gt;&#10;{% endif %}&#10;&lt;/div&gt;&#10;&#10;&lt;!-- Add Student Modal --&gt;&#10;&lt;div class=&quot;modal fade&quot; id=&quot;addStudentRecordModal&quot; tabindex=&quot;-1&quot; aria-labelledby=&quot;addStudentRecordModalLabel&quot; aria-hidden=&quot;true&quot;&gt;&#10;    &lt;div class=&quot;modal-dialog modal-lg&quot;&gt;&#10;        &lt;div class=&quot;modal-content&quot;&gt;&#10;            &lt;div class=&quot;modal-body&quot;&gt;&#10;                &lt;div class=&quot;text-center&quot;&gt;&#10;                    &lt;div class=&quot;spinner-border&quot; role=&quot;status&quot;&gt;&#10;                        &lt;span class=&quot;visually-hidden&quot;&gt;Loading...&lt;/span&gt;&#10;                    &lt;/div&gt;&#10;                &lt;/div&gt;&#10;            &lt;/div&gt;&#10;        &lt;/div&gt;&#10;    &lt;/div&gt;&#10;&lt;/div&gt;&#10;&#10;&lt;!-- Edit Student Modal - Dynamic --&gt;&#10;&lt;div class=&quot;modal fade&quot; id=&quot;editStudentRecordModal&quot; tabindex=&quot;-1&quot; aria-labelledby=&quot;editStudentRecordModalLabel&quot; aria-hidden=&quot;true&quot;&gt;&#10;    &lt;div class=&quot;modal-dialog modal-lg&quot;&gt;&#10;        &lt;div class=&quot;modal-content&quot;&gt;&#10;            &lt;div class=&quot;modal-body&quot;&gt;&#10;                &lt;div class=&quot;text-center&quot;&gt;&#10;                    &lt;div class=&quot;spinner-border&quot; role=&quot;status&quot;&gt;&#10;                        &lt;span class=&quot;visually-hidden&quot;&gt;Loading...&lt;/span&gt;&#10;                    &lt;/div&gt;&#10;                &lt;/div&gt;&#10;            &lt;/div&gt;&#10;        &lt;/div&gt;&#10;    &lt;/div&gt;&#10;&lt;/div&gt;&#10;&#10;&lt;script&gt;&#10;// Load add student record modal dynamically&#10;document.addEventListener('DOMContentLoaded', function() {&#10;    const addBtn = document.querySelector('[data-bs-target=&quot;#addStudentRecordModal&quot;]');&#10;    if (addBtn) {&#10;        addBtn.addEventListener('click', function() {&#10;            const modalElement = document.getElementById('addStudentRecordModal');&#10;            &#10;            // Load fresh modal content each time&#10;            fetch('{% url &quot;add&quot; %}', {&#10;                headers: {&#10;                    'X-Requested-With': 'XMLHttpRequest',&#10;                }&#10;            })&#10;            .then(response =&gt; response.text())&#10;            .then(html =&gt; {&#10;                const modalContent = modalElement.querySelector('.modal-content');&#10;                if (modalContent) {&#10;                    modalContent.innerHTML = html;&#10;                    attachFormHandler(modalElement);&#10;                    // Re-initialize scripts after content is loaded&#10;                    if (typeof initStudentRecordModal === 'function') {&#10;                        setTimeout(initStudentRecordModal, 100);&#10;                    }&#10;                }&#10;            })&#10;            .catch(error =&gt; {&#10;                console.error('Error loading modal:', error);&#10;            });&#10;        });&#10;    }&#10;    &#10;    // Handle edit student record button clicks&#10;    document.addEventListener('click', function(e) {&#10;        if (e.target.closest('.edit-student-btn')) {&#10;            const studentId = e.target.closest('.edit-student-btn').dataset.studentId;&#10;            const modalElement = document.getElementById('editStudentRecordModal');&#10;&#10;            fetch(`/edit/${studentId}/`, {&#10;                headers: {&#10;                    'X-Requested-With': 'XMLHttpRequest',&#10;                }&#10;            })&#10;            .then(response =&gt; response.text())&#10;            .then(html =&gt; {&#10;                const modalContent = modalElement.querySelector('.modal-content');&#10;                if (modalContent) {&#10;                    modalContent.innerHTML = html;&#10;                    attachFormHandler(modalElement);&#10;                    const bootstrapModal = new bootstrap.Modal(modalElement);&#10;                    bootstrapModal.show();&#10;                }&#10;            })&#10;            .catch(error =&gt; {&#10;                console.error('Error loading edit modal:', error);&#10;            });&#10;        }&#10;    });&#10;    &#10;    // Attach form submission handler to prevent normal POST and handle via AJAX&#10;    function attachFormHandler(modalElement) {&#10;        const form = modalElement.querySelector('form');&#10;        if (form &amp;&amp; form.getAttribute('data-modal-form') === 'true') {&#10;            form.addEventListener('submit', function(e) {&#10;                e.preventDefault();&#10;                const formData = new FormData(form);&#10;                const actionUrl = form.getAttribute('action');&#10;                &#10;                fetch(actionUrl, {&#10;                    method: 'POST',&#10;                    body: formData,&#10;                    headers: {&#10;                        'X-Requested-With': 'XMLHttpRequest',&#10;                    }&#10;                })&#10;                .then(response =&gt; response.json())&#10;                .then(data =&gt; {&#10;                    if (data.success) {&#10;                        alert(data.message || 'Saved successfully');&#10;                        // Close modal&#10;                        const bsModal = bootstrap.Modal.getInstance(modalElement);&#10;                        if (bsModal) bsModal.hide();&#10;                        // Reload page to show updated table&#10;                        setTimeout(() =&gt; window.location.reload(), 300);&#10;                    } else {&#10;                        alert('Error: ' + (data.message || 'Save failed'));&#10;                    }&#10;                })&#10;                .catch(error =&gt; {&#10;                    console.error('Form submission error:', error);&#10;                    alert('Error saving form');&#10;                });&#10;            });&#10;        }&#10;    }&#10;});&#10;&lt;/script&gt;&#10;&#10;&#10;{% endblock %}&#10;" />
              <option name="updatedContent" value="{% extends 'base.html' %}&#10;{% load static %}&#10;{% block title %}Student Record{% endblock %}&#10;&#10;{% block content %}&#10;    &lt;h2&gt;Student Record&lt;/h2&gt;&#10;&lt;button type=&quot;button&quot; class=&quot;btn btn-primary&quot; data-bs-toggle=&quot;modal&quot; data-bs-target=&quot;#addStudentRecordModal&quot;&gt;Add Student&lt;/button&gt;&#10;&#10;&lt;div class = &quot;table-responsive&quot;&gt;&#10;&lt;table class=&quot;table table-hover&quot;&gt;&#10;  &lt;tbody&gt;&#10;    &lt;tr&gt;&#10;      &lt;th scope=&quot;col&quot;&gt;Student ID&lt;/th&gt;&#10;      &lt;th scope=&quot;col&quot;&gt;Fullname&lt;/th&gt;&#10;      &lt;th scope=&quot;col&quot;&gt;Grade &amp; Section&lt;/th&gt;&#10;      &lt;th scope=&quot;col&quot;&gt;Gender&lt;/th&gt;&#10;       &lt;th scope=&quot;col&quot;&gt;Age&lt;/th&gt;&#10;      &lt;th scope=&quot;col&quot;&gt;Address&lt;/th&gt;&#10;      &lt;th scope=&quot;col&quot;&gt;Parent/Guardian&lt;/th&gt;&#10;      &lt;th scope=&quot;col&quot;&gt;Parent/Guardian Contact&lt;/th&gt;&#10;       &lt;th scope=&quot;col&quot;&gt;Status&lt;/th&gt;&#10;      &lt;th scope=&quot;col&quot;&gt;Actions&lt;/th&gt;&#10;    &lt;/tr&gt;&#10;  &lt;/tbody&gt;&#10;  {% for student in page_obj %}&#10;  &lt;tr&gt;&#10;    &lt;td&gt;{{ student.student_id}}&lt;/td&gt;&#10;    &lt;td&gt;{{ student.fullname}}&lt;/td&gt;&#10;    &lt;td&gt;{{ student.grade_and_section}}&lt;/td&gt;&#10;    &lt;td&gt;{{ student.gender}}&lt;/td&gt;&#10;    &lt;td&gt;{{ student.age}}&lt;/td&gt;&#10;    &lt;td&gt;{{ student.address}}&lt;/td&gt;&#10;    &lt;td&gt;{{ student.parent}}&lt;/td&gt;&#10;    &lt;td&gt;{{ student.parent_contact}}&lt;/td&gt;&#10;    &lt;td&gt;{{ student.status}}&lt;/td&gt;&#10;    &lt;td&gt;&#10;&lt;button type=&quot;button&quot;&#10;        class=&quot;btn btn-success me-1&quot;&#10;        data-bs-toggle=&quot;modal&quot;&#10;        data-bs-target=&quot;#mymodal{{student.id}}&quot;&gt;&#10;  &lt;i class=&quot;fa-solid fa-circle-info&quot;&gt;&lt;/i&gt;&#10;&lt;/button&gt;&#10;&#10;&lt;!--      modal view student--&gt;&#10;  &lt;div class=&quot;modal&quot; id =&quot;mymodal{{student.id}}&quot; tabindex=&quot;-1&quot; aria-labelledby=&quot;mymodalLabel{{student.id}}&quot; aria-hidden=&quot;true&quot;&gt;&#10;  &lt;div class=&quot;modal-dialog&quot; role=&quot;document&quot;&gt;&#10;    &lt;div class=&quot;modal-content&quot;&gt;&#10;      &lt;div class=&quot;modal-header&quot;&gt;&#10;        &lt;h5 class=&quot;modal-title&quot;&gt;&#10;          Student: {{ student.fullname}}&#10;        &lt;/h5&gt;&#10;        &lt;button type=&quot;button&quot; class=&quot;btn-close&quot; data-bs-dismiss=&quot;modal&quot; aria-label=&quot;Close&quot;&gt;&#10;          &lt;span aria-hidden=&quot;true&quot;&gt;&lt;/span&gt;&#10;        &lt;/button&gt;&#10;      &lt;/div&gt;&#10;      &lt;div class=&quot;modal-body&quot;&gt;&#10;        &lt;ul class=&quot;list-unstyled&quot;&gt;&#10;          &lt;li&gt;Student ID: &lt;strong&gt; {{ student.student_id}} &lt;/strong&gt;&lt;/li&gt;&#10;          &lt;li&gt;Fullname: &lt;strong&gt; {{ student.fullname}}&lt;/strong&gt;&lt;/li&gt;&#10;          &lt;li&gt;Grade &amp; Section: &lt;strong&gt; {{ student.grade_and_section}}&lt;/strong&gt;&lt;/li&gt;&#10;          &lt;li&gt;Gender: &lt;strong&gt; {{ student.gender}}&lt;/strong&gt;&lt;/li&gt;&#10;          &lt;li&gt;Age: &lt;strong&gt; {{ student.age}}&lt;/strong&gt;&lt;/li&gt;&#10;          &lt;li&gt;Address: &lt;strong&gt; {{ student.address}}&lt;/strong&gt;&lt;/li&gt;&#10;          &lt;li&gt;Parent/Guardian: &lt;strong&gt; {{ student.parent}}&lt;/strong&gt;&lt;/li&gt;&#10;          &lt;li&gt;Parent/Guardian Contact: &lt;strong&gt; {{ student.parent_contact}}&lt;/strong&gt;&lt;/li&gt;&#10;          &lt;li&gt;Status: &lt;strong&gt; {{ student.status}}&lt;/strong&gt;&lt;/li&gt;&#10;        &lt;/ul&gt;&#10;      &lt;/div&gt;&#10;      &lt;div class=&quot;modal-footer&quot;&gt;&#10;        &lt;button type=&quot;button&quot; class=&quot;btn btn-primary&quot; data-bs-dismiss=&quot;modal&quot;&gt;Close&lt;/button&gt;&#10;      &lt;/div&gt;&#10;    &lt;/div&gt;&#10;  &lt;/div&gt;&#10;&lt;/div&gt;&#10;&lt;!--      modal delete student--&gt;&#10;      &lt;button type=&quot;button&quot; class=&quot;btn btn-warning me-1 edit-student-btn&quot; data-student-id=&quot;{{ student.id }}&quot;&gt;&#10;        &lt;i class=&quot;fa-solid fa-pen-to-square&quot;&gt;&lt;/i&gt;&#10;      &lt;/button&gt;&#10;      &lt;button type=&quot;button&quot; class=&quot;btn btn-danger&quot; data-bs-toggle = &quot;modal&quot; data-bs-target=&quot;#delete{{student.id}}&quot;&gt;&#10;        &lt;i class=&quot;fa-solid fa-trash-can&quot;&gt;&lt;/i&gt;&#10;      &lt;/button&gt;&#10;      &lt;div class=&quot;modal&quot; id =&quot;delete{{student.id}}&quot; tabindex=&quot;-1&quot; aria-labelledby=&quot;mymodalLabel{{student.id}}&quot; aria-hidden=&quot;true&quot;&gt;&#10;  &lt;div class=&quot;modal-dialog&quot; role=&quot;document&quot;&gt;&#10;    &lt;div class=&quot;modal-content&quot;&gt;&#10;      &lt;div class=&quot;modal-header&quot;&gt;&#10;        &lt;h5 class=&quot;modal-title&quot;&gt;&#10;          Student: {{ student.fullname}}&#10;        &lt;/h5&gt;&#10;        &lt;button type=&quot;button&quot; class=&quot;btn-close&quot; data-bs-dismiss=&quot;modal&quot; aria-label=&quot;Close&quot;&gt;&#10;          &lt;span aria-hidden=&quot;true&quot;&gt;&lt;/span&gt;&#10;        &lt;/button&gt;&#10;      &lt;/div&gt;&#10;      &lt;div class=&quot;modal-body&quot;&gt;&#10;        &lt;p&gt;Are you sure you want to delete this student?&lt;/p&gt;&#10;      &lt;/div&gt;&#10;     &lt;div class=&quot;modal-footer&quot;&gt;&#10;  &lt;form action=&quot;{% url 'delete' student.id %}&quot; method=&quot;POST&quot;&gt;&#10;    {% csrf_token %}&#10;    &lt;input type=&quot;submit&quot; class=&quot;btn btn-danger&quot; value=&quot;Delete&quot;&gt;&#10;    &lt;button type=&quot;button&quot; class=&quot;btn btn-secondary&quot; data-bs-dismiss=&quot;modal&quot;&gt;Cancel&lt;/button&gt;&#10;  &lt;/form&gt;&#10;&lt;/div&gt;&#10;&#10;      &lt;/div&gt;&#10;    &lt;/div&gt;&#10;  &lt;/div&gt;&#10;&lt;/div&gt;&#10;&#10;    &lt;/td&gt;&#10;  &lt;/tr&gt;&#10;  {%endfor%}&#10;&lt;/table&gt;&#10;&#10;&lt;!-- Pagination --&gt;&#10;{% if page_obj %}&#10;&lt;nav aria-label=&quot;Page navigation&quot; class=&quot;mt-3&quot;&gt;&#10;    &lt;ul class=&quot;pagination justify-content-center&quot;&gt;&#10;        {% if page_obj.has_previous %}&#10;            &lt;li class=&quot;page-item&quot;&gt;&#10;                &lt;a class=&quot;page-link&quot; href=&quot;?page={{ page_obj.previous_page_number }}&quot;&gt;Previous&lt;/a&gt;&#10;            &lt;/li&gt;&#10;        {% endif %}&#10;        &#10;        {% for num in page_obj.paginator.page_range %}&#10;            {% if page_obj.number == num %}&#10;                &lt;li class=&quot;page-item active&quot;&gt;&lt;span class=&quot;page-link&quot;&gt;{{ num }}&lt;/span&gt;&lt;/li&gt;&#10;            {% elif num &gt; page_obj.number|add:'-3' and num &lt; page_obj.number|add:'3' %}&#10;                &lt;li class=&quot;page-item&quot;&gt;&#10;                    &lt;a class=&quot;page-link&quot; href=&quot;?page={{ num }}&quot;&gt;{{ num }}&lt;/a&gt;&#10;                &lt;/li&gt;&#10;            {% endif %}&#10;        {% endfor %}&#10;        &#10;        {% if page_obj.has_next %}&#10;            &lt;li class=&quot;page-item&quot;&gt;&#10;                &lt;a class=&quot;page-link&quot; href=&quot;?page={{ page_obj.next_page_number }}&quot;&gt;Next&lt;/a&gt;&#10;            &lt;/li&gt;&#10;        {% endif %}&#10;    &lt;/ul&gt;&#10;&lt;/nav&gt;&#10;{% endif %}&#10;&lt;/div&gt;&#10;&#10;&lt;!-- Add Student Modal --&gt;&#10;&lt;div class=&quot;modal fade&quot; id=&quot;addStudentRecordModal&quot; tabindex=&quot;-1&quot; aria-labelledby=&quot;addStudentRecordModalLabel&quot; aria-hidden=&quot;true&quot;&gt;&#10;    &lt;div class=&quot;modal-dialog modal-lg&quot;&gt;&#10;        &lt;div class=&quot;modal-content&quot;&gt;&#10;            &lt;div class=&quot;modal-body&quot;&gt;&#10;                &lt;div class=&quot;text-center&quot;&gt;&#10;                    &lt;div class=&quot;spinner-border&quot; role=&quot;status&quot;&gt;&#10;                        &lt;span class=&quot;visually-hidden&quot;&gt;Loading...&lt;/span&gt;&#10;                    &lt;/div&gt;&#10;                &lt;/div&gt;&#10;            &lt;/div&gt;&#10;        &lt;/div&gt;&#10;    &lt;/div&gt;&#10;&lt;/div&gt;&#10;&#10;&lt;!-- Edit Student Modal - Dynamic --&gt;&#10;&lt;div class=&quot;modal fade&quot; id=&quot;editStudentRecordModal&quot; tabindex=&quot;-1&quot; aria-labelledby=&quot;editStudentRecordModalLabel&quot; aria-hidden=&quot;true&quot;&gt;&#10;    &lt;div class=&quot;modal-dialog modal-lg&quot;&gt;&#10;        &lt;div class=&quot;modal-content&quot;&gt;&#10;            &lt;div class=&quot;modal-body&quot;&gt;&#10;                &lt;div class=&quot;text-center&quot;&gt;&#10;                    &lt;div class=&quot;spinner-border&quot; role=&quot;status&quot;&gt;&#10;                        &lt;span class=&quot;visually-hidden&quot;&gt;Loading...&lt;/span&gt;&#10;                    &lt;/div&gt;&#10;                &lt;/div&gt;&#10;            &lt;/div&gt;&#10;        &lt;/div&gt;&#10;    &lt;/div&gt;&#10;&lt;/div&gt;&#10;&#10;&lt;script&gt;&#10;// Load add student record modal dynamically&#10;document.addEventListener('DOMContentLoaded', function() {&#10;    const addBtn = document.querySelector('[data-bs-target=&quot;#addStudentRecordModal&quot;]');&#10;    if (addBtn) {&#10;        addBtn.addEventListener('click', function() {&#10;            const modalElement = document.getElementById('addStudentRecordModal');&#10;&#10;            // Load fresh modal content each time&#10;            fetch('{% url &quot;add&quot; %}', {&#10;                headers: {&#10;                    'X-Requested-With': 'XMLHttpRequest',&#10;                }&#10;            })&#10;            .then(response =&gt; response.text())&#10;            .then(html =&gt; {&#10;                const tempDiv = document.createElement('div');&#10;                tempDiv.innerHTML = html;&#10;&#10;                // Prefer a full modal structure if present, otherwise modal-content&#10;                const fullModal = tempDiv.querySelector('.modal');&#10;                let contentHtml = null;&#10;                if (fullModal) {&#10;                    const modalContent = fullModal.querySelector('.modal-content');&#10;                    if (modalContent) contentHtml = modalContent.innerHTML;&#10;                }&#10;                if (!contentHtml) {&#10;                    const modalContentDirect = tempDiv.querySelector('.modal-content');&#10;                    if (modalContentDirect) contentHtml = modalContentDirect.innerHTML;&#10;                }&#10;&#10;                const targetContent = modalElement.querySelector('.modal-content');&#10;                if (targetContent &amp;&amp; contentHtml !== null) {&#10;                    targetContent.innerHTML = contentHtml;&#10;                    attachFormHandler(modalElement);&#10;                    // Re-initialize scripts after content is loaded&#10;                    if (typeof initStudentRecordModal === 'function') {&#10;                        setTimeout(initStudentRecordModal, 100);&#10;                    }&#10;                } else if (targetContent) {&#10;                    // Fallback: inject raw HTML if structure differs&#10;                    targetContent.innerHTML = html;&#10;                    attachFormHandler(modalElement);&#10;                }&#10;            })&#10;            .catch(error =&gt; {&#10;                console.error('Error loading modal:', error);&#10;            });&#10;        });&#10;    }&#10;&#10;    // Handle edit student record button clicks (delegated)&#10;    document.addEventListener('click', function(e) {&#10;        const btn = e.target.closest('.edit-student-btn');&#10;        if (btn) {&#10;            const studentId = btn.dataset.studentId;&#10;            const modalElement = document.getElementById('editStudentRecordModal');&#10;&#10;            fetch(`/edit/${studentId}/`, {&#10;                headers: {&#10;                    'X-Requested-With': 'XMLHttpRequest',&#10;                }&#10;            })&#10;            .then(response =&gt; response.text())&#10;            .then(html =&gt; {&#10;                const tempDiv = document.createElement('div');&#10;                tempDiv.innerHTML = html;&#10;&#10;                const fullModal = tempDiv.querySelector('.modal');&#10;                let contentHtml = null;&#10;                if (fullModal) {&#10;                    const modalContent = fullModal.querySelector('.modal-content');&#10;                    if (modalContent) contentHtml = modalContent.innerHTML;&#10;                }&#10;                if (!contentHtml) {&#10;                    const modalContentDirect = tempDiv.querySelector('.modal-content');&#10;                    if (modalContentDirect) contentHtml = modalContentDirect.innerHTML;&#10;                }&#10;&#10;                const targetContent = modalElement.querySelector('.modal-content');&#10;                if (targetContent &amp;&amp; contentHtml !== null) {&#10;                    targetContent.innerHTML = contentHtml;&#10;                    attachFormHandler(modalElement);&#10;                    const bootstrapModal = new bootstrap.Modal(modalElement);&#10;                    bootstrapModal.show();&#10;                } else if (targetContent) {&#10;                    // Fallback: inject raw HTML&#10;                    targetContent.innerHTML = html;&#10;                    attachFormHandler(modalElement);&#10;                    const bootstrapModal = new bootstrap.Modal(modalElement);&#10;                    bootstrapModal.show();&#10;                }&#10;            })&#10;            .catch(error =&gt; {&#10;                console.error('Error loading edit modal:', error);&#10;            });&#10;        }&#10;    });&#10;&#10;    // Attach form submission handler to prevent normal POST and handle via AJAX&#10;    function attachFormHandler(modalElement) {&#10;        const form = modalElement.querySelector('form');&#10;        if (form &amp;&amp; form.getAttribute('data-modal-form') === 'true') {&#10;            // Remove any previously attached handler to avoid duplicates&#10;            if (form._attachedHandler) {&#10;                form.removeEventListener('submit', form._attachedHandler);&#10;            }&#10;&#10;            const handler = function(e) {&#10;                e.preventDefault();&#10;                const formData = new FormData(form);&#10;                const actionUrl = form.getAttribute('action');&#10;&#10;                fetch(actionUrl, {&#10;                    method: 'POST',&#10;                    body: formData,&#10;                    headers: {&#10;                        'X-Requested-With': 'XMLHttpRequest',&#10;                    }&#10;                })&#10;                .then(async response =&gt; {&#10;                    // Try to parse JSON; if it isn't JSON, return text&#10;                    const ct = response.headers.get('content-type') || '';&#10;                    if (ct.includes('application/json')) return response.json();&#10;                    const text = await response.text();&#10;                    return { success: false, message: 'Invalid server response', _raw: text };&#10;                })&#10;                .then(data =&gt; {&#10;                    if (data &amp;&amp; data.success) {&#10;                        // If server returned HTML for the new row, insert it into the table&#10;                        if (data.row_html) {&#10;                            let tbody = document.getElementById('students-tbody');&#10;                            if (!tbody) {&#10;                                // If tbody doesn't exist, try to find the table and create tbody&#10;                                const table = document.querySelector('.table.table-hover');&#10;                                if (table) {&#10;                                    tbody = table.querySelector('tbody') || document.createElement('tbody');&#10;                                    if (!table.querySelector('tbody')) table.appendChild(tbody);&#10;                                    tbody.id = 'students-tbody';&#10;                                }&#10;                            }&#10;                            if (tbody) {&#10;                                tbody.insertAdjacentHTML('afterbegin', data.row_html);&#10;                            }&#10;                        }&#10;&#10;                        // If server returned modal HTML (edit modal), append it to body so edit works&#10;                        if (data.modal_html) {&#10;                            document.body.insertAdjacentHTML('beforeend', data.modal_html);&#10;                        }&#10;&#10;                        // Close modal&#10;                        const bsModal = bootstrap.Modal.getInstance(modalElement);&#10;                        if (bsModal) bsModal.hide();&#10;&#10;                        // Attach handlers for the newly inserted edit modal if server provided student_id&#10;                        if (data.student_id) {&#10;                            const newEditModal = document.getElementById('editStudentRecordModal' + data.student_id);&#10;                            if (newEditModal) {&#10;                                attachFormHandler(newEditModal);&#10;                            }&#10;                        }&#10;&#10;                        // Show friendly message&#10;                        if (data.message) {&#10;                            // small inline notification could go here; using alert for parity&#10;                            alert(data.message);&#10;                        }&#10;                    } else {&#10;                        // Show validation errors if provided&#10;                        if (data &amp;&amp; data.errors) {&#10;                            let errMsg = data.message || 'Validation failed';&#10;                            for (const [field, messages] of Object.entries(data.errors)) {&#10;                                errMsg += '\n' + field + ': ' + messages.join(', ');&#10;                            }&#10;                            alert(errMsg);&#10;                        } else {&#10;                            alert((data &amp;&amp; data.message) || 'Error saving form');&#10;                        }&#10;                    }&#10;                })&#10;                .catch(error =&gt; {&#10;                    console.error('Form submission error:', error);&#10;                    alert('Error saving form');&#10;                });&#10;            };&#10;&#10;            form.addEventListener('submit', handler);&#10;            form._attachedHandler = handler;&#10;        }&#10;    }&#10;});&#10;&lt;/script&gt;&#10;&#10;&#10;{% endblock %}" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>